<!-- Enhanced Product Card - Pure PrimeNG + Tailwind CSS -->
<div class="group relative overflow-hidden rounded-xl bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 shadow-sm hover:shadow-xl transition-all duration-300 hover:-translate-y-2 cursor-pointer h-full flex flex-col"
     (click)="viewProductDetails()"
     [ariaLabel]="'View details for ' + product().title">
  
  <!-- Product Image Container -->
  <div class="relative overflow-hidden bg-gradient-to-br from-gray-50 to-gray-100 dark:from-gray-700 dark:to-gray-600">
    <img 
      [src]="product().imageCover" 
      [alt]="product().title"
      class="w-full h-48 object-cover transition-transform duration-500 group-hover:scale-110"
      loading="lazy">
    
    <!-- Discount Badge -->
    @if (hasDiscount()) {
      <p-badge 
        [value]="discountPercentage()"
        severity="danger"
        class="!absolute !top-3 !left-3 !text-xs !font-bold !px-2 !py-1">
      </p-badge>
    }
    
    <!-- Wishlist Button -->
    <p-button
      [icon]="wishlistIconClass()"
      (click)="onWishlistClick($event)"
      [rounded]="true"
      [text]="true"
      [loading]="isTogglingWishlist()"
      [severity]="isInWishlist() ? 'danger' : 'secondary'"
      size="small"
      class="!absolute !top-3 !right-3 !w-8 !h-8 !rounded-full !drop-shadow-md hover:!drop-shadow-lg !transition-all !duration-200 hover:!scale-110"
      [class.!bg-white/90]="isInWishlist()"
      [class.hover:!bg-white/20]="!isInWishlist()"
      [ariaLabel]="isInWishlist() ? 'Remove ' + product().title + ' from wishlist' : 'Add ' + product().title + ' to wishlist'">
    </p-button>
  </div>
  
  <!-- Product Info -->
  <div class="p-4 flex-1 flex flex-col">
    
    <!-- Centered Brand Badge -->
    <div class="flex justify-center mb-3">
      <p-badge 
        [value]="product().brand.name" 
        class="!text-xs !font-bold !uppercase !tracking-wide !px-3 !py-1.5 !bg-blue-50 !text-blue-700 dark:!bg-blue-900/30 dark:!text-blue-300 !border-0 !rounded-full !shadow-sm">
      </p-badge>
    </div>
    
    <!-- Product Title -->
    <h3 class="text-xs sm:text-sm font-semibold text-gray-900 dark:text-white mb-3 line-clamp-2 leading-relaxed min-h-[2.75rem] sm:min-h-[3rem]">
      {{ product().title }}
    </h3>
    
    <!-- Rating Section (Always Present for Consistent Height) -->
    <div class="flex items-center gap-2 mb-3 min-h-[1.25rem]">
      @if (product().ratingsAverage > 0) {
        <p-rating 
          [ngModel]="product().ratingsAverage" 
          [readonly]="true"
          [stars]="5"
          class="!text-xs">
        </p-rating>
        <span class="text-xs text-gray-500 dark:text-gray-400">
          {{ product().ratingsAverage }}/5 ({{ product().ratingsQuantity || 0 }})
        </span>
      } @else {
        <!-- Empty space to maintain consistent height -->
        <div class="h-4"></div>
      }
    </div>
    
    <!-- Price Section -->
    <div class="mb-4 mt-auto">
      <div class="flex items-center gap-2 mb-1">
        <!-- Current/Discounted Price -->
        <span class="text-base sm:text-lg font-bold text-green-600 dark:text-green-400">
          {{ currentPrice() | number:'1.0-0' }} EGP
        </span>
        
        <!-- Original Price (if discounted) -->
        @if (hasDiscount()) {
          <span class="text-sm text-gray-500 dark:text-gray-400 line-through decoration-2">
            {{ product().price | number:'1.0-0' }} EGP
          </span>
        }
      </div>
      
      <!-- Stock Status -->
      @if (product().quantity > 0) {
        <p class="text-xs text-green-600 dark:text-green-400 font-medium">
          <i class="pi pi-check-circle mr-1"></i>
          In Stock
        </p>
      } @else {
        <p class="text-xs text-red-500 font-medium">
          <i class="pi pi-times-circle mr-1"></i>
          Out of Stock
        </p>
      }
    </div>
  </div>
  
  <!-- Action Buttons Footer -->
  <div class="p-4 pt-0 flex justify-center">
    <!-- Add to Cart Button (Not in cart) -->
    @if (!isInCart()) {
      <p-button 
        label="Add to Cart"
        icon="pi pi-shopping-cart"
        (click)="onAddToCartClick($event)"
        severity="success"
        size="small"
        [loading]="isAddingToCart()"
        [disabled]="!canAddToCart()"
        class="!py-1.5 sm:!py-2 !text-xs !font-semibold">
      </p-button>
    } @else {
      <!-- In Cart - Show quantity and view cart option -->
      <div class="flex items-center gap-2">
        <p-chip 
          [label]="'In Cart (' + cartQuantity() + ')'"
          icon="pi pi-check"
          class="!bg-green-50 !text-green-700 dark:!bg-green-900/30 dark:!text-green-300 !text-xs !font-semibold">
        </p-chip>
        <p-button 
          icon="pi pi-plus"
          (click)="onAddToCartClick($event)"
          severity="success"
          size="small"
          [loading]="isAddingToCart()"
          [disabled]="!canAddToCart()"
          [text]="true"
          class="!w-6 !h-6 !p-0"
          [ariaLabel]="'Add another ' + product().title + ' to cart'">
        </p-button>
      </div>
    }
  </div>
  
</div>
