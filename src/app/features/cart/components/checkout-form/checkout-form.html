<p-card>
  <ng-template pTemplate="header">
    <div class="flex items-center gap-3 p-4 bg-emphasis">
      <i class="pi pi-map-marker text-primary"></i>
      <h3 class="font-semibold text-color">Shipping Address</h3>
    </div>
  </ng-template>
  
  <form [formGroup]="checkoutForm" class="space-y-4">
    <!-- Address Name -->
    <div>
      <label for="name" class="block text-sm font-medium text-color mb-2">
        Address Label <span class="text-red-500">*</span>
      </label>
      <input
        id="name"
        pInputText
        formControlName="name"
        placeholder="e.g., Home, Work, Mom's House"
        class="w-full"
        [class.p-invalid]="isFieldInvalid('name')"
        aria-describedby="name-error" />
      @if (isFieldInvalid('name')) {
        <small id="name-error" class="text-red-500 mt-1 block">
          @if (checkoutForm.get('name')?.errors?.['required']) {
            Address label is required
          }
          @if (checkoutForm.get('name')?.errors?.['minlength']) {
            Address label must be at least 2 characters
          }
        </small>
      }
      <small class="text-muted-color text-xs mt-1 block">
        Give this address a name to easily identify it later
      </small>
    </div>

    <!-- Address Details -->
    <div>
      <label for="details" class="block text-sm font-medium text-color mb-2">
        Address Details <span class="text-red-500">*</span>
      </label>
      <textarea
        id="details"
        pTextarea
        formControlName="details"
        placeholder="Enter your full address (street, building number, apartment, etc.)"
        rows="3"
        class="w-full"
        [class.p-invalid]="isFieldInvalid('details')"
        aria-describedby="details-error">
      </textarea>
      @if (isFieldInvalid('details')) {
        <small id="details-error" class="text-red-500 mt-1 block">
          @if (checkoutForm.get('details')?.errors?.['required']) {
            Address details are required
          }
          @if (checkoutForm.get('details')?.errors?.['minAddressLength']) {
            Address must be at least 10 characters
          }
        </small>
      }
    </div>

    <!-- Phone Number -->
    <div>
      <label for="phone" class="block text-sm font-medium text-color mb-2">
        Phone Number <span class="text-red-500">*</span>
      </label>
      <input
        id="phone"
        pInputText
        formControlName="phone"
        placeholder="01234567890"
        class="w-full"
        [class.p-invalid]="isFieldInvalid('phone')"
        aria-describedby="phone-error" />
      @if (isFieldInvalid('phone')) {
        <small id="phone-error" class="text-red-500 mt-1 block">
          @if (checkoutForm.get('phone')?.errors?.['required']) {
            Phone number is required
          }
          @if (checkoutForm.get('phone')?.errors?.['invalidEgyptianPhone']) {
            Please enter a valid Egyptian phone number (11 digits starting with 01)
          }
        </small>
      }
    </div>

    <!-- City -->
    <div>
      <label for="city" class="block text-sm font-medium text-color mb-2">
        City <span class="text-red-500">*</span>
      </label>
      <p-select
        formControlName="city"
        [options]="egyptianCities"
        placeholder="Select your city"
        [showClear]="true"
        [filter]="true"
        filterBy="label"
        class="w-full"
        [class.p-invalid]="isFieldInvalid('city')"
        aria-describedby="city-error">
      </p-select>
      @if (isFieldInvalid('city')) {
        <small id="city-error" class="text-red-500 mt-1 block">
          City selection is required
        </small>
      }
    </div>
  </form>
</p-card>

